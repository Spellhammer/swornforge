<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SwornForge</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="vanillaui.css">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="engine.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <div 
        class="sworn-forge-asset-creator" 
        x-data="swornForgeAssetCreator()"
        x-init="transformers.italicizeMoveNames()">
        <div class="controls">
            <fieldset>
                <legend>Asset Options</legend>
                <label>
                    <span>Asset Name</span>
                    <input type="text" x-model="options.assetName">
                </label>
                <label>
                    <span>Asset Description</span>
                    <input type="text" x-model="options.description">
                </label>
                <label>
                    <span>Include Name Fill-in</span>
                    <input type="checkbox" :checked="options.name" x-model="options.name">
                </label>
                <label>
                    <span>Include Health/Resource Track</span>
                    <input type="checkbox" :checked="options.track" x-model="options.track">
                </label>
                <label>
                    <span>Max Health/Resource</span>
                    <input type="number" min="1" :max="staticOptions.maxTrackSize" x-model.number="options.trackMax">
                </label>
                <label>
                    <span>Type</span>
                    <select x-model="options.type">
                        <template x-for="option in staticOptions.builtinTypes" :key="option">
                            <option x-text="option"></option>
                        </template>
                    </select>
                </label>
                <label x-show="options.type == 'Custom'">
                    <span>Custom Type Name</span>
                    <input type="text" x-model="options.customType">
                </label>
                <fieldset>
                    <legend>Fill-ins</legend>
                    <template x-for="(fillIn, index) in options.fillIns">
                        <fieldset>
                            <legend>Fill-in</legend>
                            <label class="control">
                                <span>Fill-in Title</span>
                                <input type="text" x-model="fillIn.title">
                            </label>
                            <button @click="options.fillIns.splice(index, 1)">Remove</button>
                        </fieldset>
                    </template>
                    <button @click="options.fillIns.push({title: 'Fill-in:'})">Add Fill-in</button>
                </fieldset>
            </fieldset>
            <fieldset>
                <legend>Power List</legend>
                <template x-for="(power, index) in powers">
                    <fieldset>
                        <legend>Power</legend>
                        <label class="control">
                            <span>Power Title</span>
                            <input type="text" x-model="power.title">
                        </label>
                        <label class="control">
                            <span>Unlocked</span>
                            <input type="checkbox" x-model="power.unlocked">
                        </label>
                        <label class="control--vertical">
                            <span>Power Description</span>
                            <textarea x-model="power.description"></textarea>
                        </label>
                        <details>
                            <summary>Sub-powers / Options</summary>
                            <fieldset>
                                <legend>Sub-powers / Options</legend>
                                <template x-for="(subpower, index) in power.powers">
                                    <fieldset>
                                        <legend>Sub-power/Option</legend>
                                        <label class="control">
                                            <span>Subpower Title</span>
                                            <input type="text" x-model="subpower.title">
                                        </label>
                                        <label class="control">
                                            <span>Unlocked</span>
                                            <input type="checkbox" x-model="subpower.unlocked">
                                        </label>
                                        <label class="control--vertical">
                                            <span>Subpower Description</span>
                                            <textarea x-model="subpower.description"></textarea>
                                        </label>
                                        <button x-on:click="power.powers.splice(index, 1)">Remove</button>
                                    </fieldset>
                                </template>
                                <button @click="power.powers.push({title: 'New Subpower', unlocked: false, description: 'Something awesome that this subpower does.'})">Add Subpower</button>
                            </fieldset>
                        </details>
                        <label>
                            <span>Fill-in</span>
                            <input type="checkbox" x-model="power.fillin">
                        </label>
                        <label x-show="power.fillin">
                            <span>Fill-in Title</span>
                            <input type="text" x-model="power.fillinTitle">
                        </label>
                        <button x-on:click="powers.splice(index, 1)">Remove</button>
                    </fieldset>
                </template>
                <button @click="powers.push({title: 'New Power', unlocked: false, description: 'Something awesome that this power does.'})">Add Power</button>
            </fieldset>
        </div>
        <div class="asset-card-wrapper">
            <div class="asset-card-safety-zone">
                <div class="asset-card" type="companion">
                    <div class="asset-card__header">
                        <p class="asset-card__type" x-text="options.type != 'Custom' ? options.type : options.customType">Companion</p>
                        <img class="asset-card__icon" />
                    </div>
                    <div class="asset-card__body">
                        <p class="asset-card__title" x-text="options.assetName">Cave Lion</p>
                        <template x-for="fillIn in options.fillIns">
                            <p class="asset-card__fillin-wrapper" x-text="fillIn.title"></p>
                        </template>
                        <div class="asset-card__description-wrapper" x-show="options.description !== ''">
                            <p x-text="options.description">Your cat takes down its prey.</p>
                        </div>
                        <ul class="asset-card__powers-list">
                            <template x-for="power in powers">
                                <li :class="{unlocked: power.unlocked}">
                                    <strong x-text="power.title"></strong><span x-html="' ' +transformers.italicizeMoveNames(power.description, moves)"></span>
                                    <ul x-show="power.powers.length > 0">
                                        <template x-for="subpower in power.powers">
                                            <li :class="{unlocked: subpower.unlocked}"><strong x-text="subpower.title"></strong><span x-html="' ' +transformers.italicizeMoveNames(subpower.description, moves)"></span></li>
                                        </template>
                                    </ul>
                                    <br x-show="power.fillin">
                                    <p class="asset-card__fillin-wrapper" x-show="power.fillin" x-text="power.fillinTitle"></p>
                                </li>
                            </template>
                        </ul>
                        <div x-show="options.track" class="asset-card__companion-track-wrapper">
                            <template x-for="i in Array.from({length: options.trackMax}, (v, k) => k)">
                                <p class="asset-card__companion-track-cell" x-text="'+' + i"></p>
                            </template>
                            <template x-for="6 in Array.from({length: staticOptions.maxTrackSize - options.trackMax}, (v, k) => k)">
                                <p class="asset-card__companion-track-cell-placeholder" data-html2canvas-ignore></p>
                            </template>
                        </div>
                    </div>
                </div> 
            </div> 
        </div>     
        <div class="sworn-forge-download-container">
            <button @click="methods.download(document.querySelector('.asset-card'))">Generate Image</button>
            <div id="output"></div>
            <p>Right-click to save or copy this image.</p>
        </div>
    </div>
</body>
</html>